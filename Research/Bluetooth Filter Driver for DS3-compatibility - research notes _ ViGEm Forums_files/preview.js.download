"use strict";define("composer/preview",["hooks"],function(e){var i={};i.render=function(i,n){n=n||function(){};if(!i.find(".preview-container").is(":visible")){return n()}var r=i.find("textarea");socket.emit("plugins.composer.renderPreview",r.val(),function(r,o){if(r){return}o=$("<div>"+o+"</div>");o.find("img:not(.not-responsive)").addClass("img-responsive");i.find(".preview").html(o);e.fire("action:composer.preview");n()})};i.matchScroll=function(e){if(!e.find(".preview-container").is(":visible")){return}var i=e.find("textarea");var n=e.find(".preview");if(i.length&&n.length){var r=i[0].scrollHeight-i.height();if(r===0){return}var o=i.scrollTop()/r;n.scrollTop(Math.max(n[0].scrollHeight-n.height(),0)*o)}};i.handleToggler=function(e){i.env=utils.findBootstrapEnvironment();var n=e.find(".write-container .toggle-preview");var r=e.find(".preview-container .toggle-preview");var o=$(".preview-container");var t=$(".write-container");function s(){a(false);if(i.env!=="xs"&&i.env!=="sm"){localStorage.setItem("composer:previewToggled",true)}}function l(){a(true);if(i.env!=="xs"&&i.env!=="sm"){localStorage.removeItem("composer:previewToggled")}}function a(r){if(i.env==="xs"||i.env==="sm"){o.toggleClass("hide",false);t.toggleClass("maximized",false);n.toggleClass("hide",true);o.toggleClass("hidden-xs hidden-sm",!r);t.toggleClass("hidden-xs hidden-sm",r);if(r){i.render(e)}}else{o.toggleClass("hide",!r);t.toggleClass("maximized",!r);n.toggleClass("hide",r)}i.matchScroll(e)}i.toggle=a;r.on("click",function(){s();e.find(".write").focus()});n.on("click",function(){l();e.find(".write").focus()});if(localStorage.getItem("composer:previewToggled")||(i.env==="xs"||i.env==="sm")){s()}else{l()}};return i});
//# sourceMappingURL=preview.js.map