"use strict";define("uploader",["jquery-form"],function(){const e={};e.show=function(e,s){const o=e.hasOwnProperty("fileSize")&&e.fileSize!==undefined?parseInt(e.fileSize,10):false;app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:e.hasOwnProperty("showHelp")&&e.showHelp!==undefined?e.showHelp:true,fileSize:o,title:e.title||"[[global:upload_file]]",description:e.description||"",button:e.button||"[[global:upload]]",accept:e.accept?e.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show");t.on("hidden.bs.modal",function(){t.remove()});const i=t.find("#uploadForm");i.attr("action",e.route);i.find("#params").val(JSON.stringify(e.params));t.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled");i.submit()});i.submit(function(){r(t,o,s);return false})})};e.hideAlerts=function(e){$(e).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function r(r,o,i){s(r,"status","[[uploads:uploading-file]]");r.find("#upload-progress-bar").css("width","0%");r.find("#upload-progress-box").show().removeClass("hide");const n=r.find("#fileInput");if(!n.val()){return s(r,"error","[[uploads:select-file-to-upload]]")}if(!t(n[0],o)){return s(r,"error","[[error:file-too-big, "+o+"]]")}e.ajaxSubmit(r,i)}function s(r,s,o){e.hideAlerts(r);if(s==="error"){r.find("#fileUploadSubmitBtn").removeClass("disabled")}r.find("#alert-"+s).translateText(o).removeClass("hide")}e.ajaxSubmit=function(r,t){const i=r.find("#uploadForm");i.ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=o(e);s(r,"error",e.responseJSON?e.responseJSON.error||e.statusText:"error uploading, code : "+e.status)},uploadProgress:function(e,s,o,t){r.find("#upload-progress-bar").css("width",t+"%")},success:function(i){let n=o(i);if(i.hasOwnProperty("response")&&i.hasOwnProperty("status")&&i.status.code==="ok"){n=i.response.images}t(n[0].url);s(r,"success","[[uploads:upload-success]]");setTimeout(function(){e.hideAlerts(r);r.modal("hide")},750)}})};function o(e){if(typeof e==="string"){try{return $.parseJSON(e)}catch(e){return{error:"[[error:parse-error]]"}}}return e}function t(e,r){if(window.FileReader&&r){return e.files[0].size<=r*1e3}return true}return e});
//# sourceMappingURL=uploader.js.map