"use strict";define("composer/autocomplete",["composer/preview"],function(e){var t={_active:{}};$(window).on("action:composer.discard",function(e,o){if(t._active.hasOwnProperty(o.post_uuid)){t._active[o.post_uuid].destroy();delete t._active[o.post_uuid]}});t.init=function(o,n){var i=o.find(".write");var r="composer-autocomplete-dropdown-"+n;var a;if(!i.length){return}var d={element:i,strategies:[],options:{style:{"z-index":2e4},className:r+" dropdown-menu textcomplete-dropdown"}};i.on("keyup",function(){clearTimeout(a);a=setTimeout(function(){var e=document.querySelector("."+r);if(e){var t=e.getBoundingClientRect();var o=parseFloat(e.style.marginTop,10)||0;var n=window.innerHeight+o-10-t.bottom;e.style.marginTop=Math.min(n,0)+"px"}},0)});$(window).trigger("composer:autocomplete:init",d);t._active[n]=t.setup(d);d.element.on("textComplete:select",function(){e.render(o)})};t.setup=function(e){var t=e.element.get(0);if(!t){return}var o;if(t.nodeName==="TEXTAREA"){var n=window.Textcomplete.editors.Textarea;o=new n(t)}else if(t.nodeName==="DIV"&&t.getAttribute("contenteditable")==="true"){var i=window.Textcomplete.editors.ContentEditable;o=new i(t)}t.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var r=new window.Textcomplete(o,{dropdown:e.options});r.register(e.strategies);r.on("rendered",function(){if(r.dropdown.items.length){r.dropdown.items[0].activate()}});return r};return t});
//# sourceMappingURL=autocomplete.js.map